<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>2026 - FINAL</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; display: flex; flex-direction: column; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        #countdown { font-size: 20vw; font-weight: bold; }
        .flash { background: white !important; }
        #btn { padding: 20px 40px; font-size: 2rem; background: #00ff88; border: none; cursor: pointer; position: absolute; z-index: 100; }
        #yt { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.5; pointer-events: none; display: none; }
    </style>
</head>
<body>

    <button id="btn" onclick="start()">DÉMARRER LE LIVE</button>
    <div id="countdown">--</div>
    <div id="yt"></div>

    <script>
        const countdownEl = document.getElementById('countdown');
        let player;
        let lastSec = -1;

        // Charger YouTube proprement
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('yt', {
                height: '100%', width: '100%',
                videoId: '3Uo0JAUWijM', // Musique festive
                events: { 'onReady': () => console.log("YT Prêt") }
            });
        }

        function speak(t) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(t);
            u.lang = 'fr-FR';
            window.speechSynthesis.speak(u);
        }

        function start() {
            document.getElementById('btn').style.display = 'none';
            update();
        }

        function update() {
            const diff = new Date("2026-01-01T00:00:00+01:00").getTime() - Date.now();
            
            if (diff <= 0) {
                countdownEl.innerHTML = "2026 !";
                document.getElementById('yt').style.display = 'block';
                if (lastSec !== 0) {
                    player.playVideo();
                    speak("Bonne année deux mille vingt-six !");
                    lastSec = 0;
                }
                return;
            }

            const secs = Math.floor(diff / 1000);
            countdownEl.innerText = secs > 60 ? Math.floor(secs/60) + "m " + (secs%60) + "s" : secs;

            if (secs <= 10 && secs !== lastSec) {
                lastSec = secs;
                speak(secs.toString());
                document.body.classList.add('flash');
                setTimeout(() => document.body.classList.remove('flash'), 50);
            }
            requestAnimationFrame(update);
        }
    </script>
</body>
</html>
